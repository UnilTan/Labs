# –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ó–ê–ü–£–°–ö–£ –õ–†-13
## –†–∞–±–æ—Ç–∞ —Å–æ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –∫–ª–∞—Å—Å–∞

---

## **–ü–û–î–ì–û–¢–û–í–ö–ê –ö –†–ê–ë–û–¢–ï**

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –õ–†-13 –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î:

```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Server Management Studio:
-- –§–∞–π–ª: Database/UpdateDatabaseForLab13.sql
```

**–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î" –≤ –≥–ª–∞–≤–Ω–æ–º –æ–∫–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.**

### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç `MilkProductsBinding`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (F5)
3. –í –≥–ª–∞–≤–Ω–æ–º –æ–∫–Ω–µ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üìä –û—Ç–∫—Ä—ã—Ç—å –õ–†-13"**

---

## **–ü–û–†–Ø–î–û–ö –í–´–ü–û–õ–ù–ï–ù–ò–Ø –†–ê–ë–û–¢–´**

### **–®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
1. –í –æ–∫–Ω–µ –õ–†-13 –Ω–∞–∂–º–∏—Ç–µ **"–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–¥–∞–∂–∏"**
2. –ù–∞–∂–º–∏—Ç–µ **"–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ—Ç–∞–ª–∏"**
3. –ò–∑—É—á–∏—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

### **–®–∞–≥ 2: –ê–Ω–∞–ª–∏–∑ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤**
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã:

**–í —Ç–∞–±–ª–∏—Ü–µ Sale:**
- **–°—É–º–º–∞ (–≤—ã—á–∏—Å–ª.)** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å—É–º–º–∞ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
- **–°–∫–∏–¥–∫–∞ ‚ÇΩ** - —Ä–∞–∑–º–µ—Ä —Å–∫–∏–¥–∫–∏ –≤ —Ä—É–±–ª—è—Ö
- **–ò—Ç–æ–≥–æ (–≤—ã—á–∏—Å–ª.)** - –∏—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ —Å —É—á–µ—Ç–æ–º —Å–∫–∏–¥–∫–∏
- **–°—É–º–º–∞ (–ë–î)** –∏ **–ò—Ç–æ–≥–æ (–ë–î)** - –∑–Ω–∞—á–µ–Ω–∏—è, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–í —Ç–∞–±–ª–∏—Ü–µ SaleDetails:**
- **–°—Ç–æ–∏–º–æ—Å—Ç—å (–≤—ã—á–∏—Å–ª.)** - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
- **–¶–µ–Ω–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ** - —Ü–µ–Ω–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Product
- **–†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω** - —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ü–µ–Ω–æ–π –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –∏ —Ü–µ–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏

### **–®–∞–≥ 3: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
1. –ù–∞–∂–º–∏—Ç–µ **"–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å"** –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –ø—Ä–æ–¥–∞–∂
2. –ù–∞–∂–º–∏—Ç–µ **"–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å"** –¥–ª—è –ø—Ä–æ–¥–∞–∂
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö "(–≤—ã—á–∏—Å–ª.)" –∏ "(–ë–î)" —Å–æ–≤–ø–∞–¥–∞—é—Ç

---

## **–ß–¢–û –î–ï–ú–û–ù–°–¢–†–ò–†–£–ï–¢ –ö–ê–ñ–î–´–ô –≠–õ–ï–ú–ï–ù–¢**

### **–í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ –∫–æ–¥–µ:**

```csharp
// –í –∫–ª–∞—Å—Å–µ SaleDetails:
[NotMapped]
public decimal SummaProductCalculated
{
    get { return QuantityProduct * UnitPrice; }
}

// –í –∫–ª–∞—Å—Å–µ Sale:
[NotMapped]
public decimal SummaSaleCalculated
{
    get { return SaleDetails.Sum(detail => detail.QuantityProduct * detail.UnitPrice); }
}

[NotMapped]
public decimal ResultatCalculated
{
    get 
    { 
        decimal summa = SummaSaleCalculated;
        decimal discount = DiscountSale ?? 0;
        return summa - (summa * discount / 100);
    }
}
```

### **–ü—Ä–∏–≤—è–∑–∫–∞ –≤ XAML:**
```xml
<!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤ -->
<DataGridTextColumn Header="–°—Ç–æ–∏–º–æ—Å—Ç—å (–≤—ã—á–∏—Å–ª.)" 
                    Binding="{Binding SummaProductCalculated, StringFormat=F2}"/>
<DataGridTextColumn Header="–ò—Ç–æ–≥–æ (–≤—ã—á–∏—Å–ª.)" 
                    Binding="{Binding ResultatCalculated, StringFormat=F2}"/>
```

---

## **–¢–ò–ü–û–í–´–ï –û–®–ò–ë–ö–ò –ò –ò–• –†–ï–®–ï–ù–ò–ï**

### ‚ùå **–û—à–∏–±–∫–∞: "–í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 0"**
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Include –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:
```csharp
var sales = db.Sale
    .Include(s => s.SaleDetails)
    .ThenInclude(sd => sd.Product)
    .ToList();
```

### ‚ùå **–û—à–∏–±–∫–∞: "Object reference not set to an instance"**
**–ü—Ä–∏—á–∏–Ω–∞:** –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–≤—è–∑–∞–Ω–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É:
```csharp
if (Product != null)
{
    return QuantityProduct * Product.priceProduct;
}
return 0;
```

### ‚ùå **–û—à–∏–±–∫–∞: "–°–≤–æ–π—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î"**
**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—Ç—Ä–∏–±—É—Ç [NotMapped]
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –∞—Ç—Ä–∏–±—É—Ç:
```csharp
[NotMapped]
public decimal SummaProductCalculated { get; }
```

---

## **–ö–û–ù–¢–†–û–õ–¨–ù–´–ï –í–û–ü–†–û–°–´**

1. **–ß—Ç–æ —Ç–∞–∫–æ–µ –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ?**
   - –°–≤–æ–π—Å—Ç–≤–æ, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π

2. **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω –∞—Ç—Ä–∏–±—É—Ç [NotMapped]?**
   - –ß—Ç–æ–±—ã Entity Framework –Ω–µ –ø—ã—Ç–∞–ª—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

3. **–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω Include –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö?**
   - –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤

4. **–ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—è –ë–î –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤?**
   - –ü—Ä–∏—Å–≤–æ–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª—è–µ–º–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ã—á–Ω–æ–º—É –ø–æ–ª—é –∏ –≤—ã–∑–≤–∞—Ç—å SaveChanges()

---

## **–î–õ–Ø –û–¢–ß–ï–¢–ê –í–ö–õ–Æ–ß–ò–¢–ï:**

### **–°–∫—Ä–∏–Ω—à–æ—Ç—ã:**
1. –û–∫–Ω–æ –õ–†-13 —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. –¢–∞–±–ª–∏—Ü–∞ Sale —Å –≤—ã—á–∏—Å–ª—è–µ–º—ã–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏
3. –¢–∞–±–ª–∏—Ü–∞ SaleDetails —Å –≤—ã—á–∏—Å–ª—è–µ–º—ã–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏
4. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### **–ö–æ–¥:**
1. –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ –∫–ª–∞—Å—Å–µ Sale
2. –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ –∫–ª–∞—Å—Å–µ SaleDetails
3. –ú–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å Include
4. –ú–µ—Ç–æ–¥ –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### **SQL:**
1. –°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ –ë–î
2. –†–µ–∑—É–ª—å—Ç–∞—Ç SELECT —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏

**–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 13 –≥–æ—Ç–æ–≤–∞ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é!**