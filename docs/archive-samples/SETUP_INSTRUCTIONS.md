# Инструкция по настройке базы данных

## Шаги для настройки в SQL Server Management Studio:

### 1. Подключение к SQL Server
- Откройте SQL Server Management Studio (SSMS)
- Подключитесь к локальному экземпляру SQL Server:
  - Server name: `.` или `localhost` или `(local)`
  - Authentication: Windows Authentication

### 2. Создание базы данных
- Откройте файл `CreateDatabase.sql` в SSMS
- Выполните весь скрипт (F5 или кнопка Execute)
- Это создаст базу данных `Familia22i1L9` с тестовыми данными

### 3. Проверка создания
После выполнения скрипта должны быть созданы:
- База данных `Familia22i1L9`
- Таблицы: `Product`, `Sale`, `SaleDetails`
- Тестовые данные в каждой таблице

### 4. Использование встроенной диагностики
В приложении есть кнопка "Тест подключения" которая:
- Автоматически проверит различные варианты подключения
- Покажет какая строка подключения работает
- Поможет создать базу данных если она не существует

### 5. Ручная настройка строки подключения
Если автоматическая диагностика не помогла, обновите строку в файле `Models/SalesContext.cs`:

```csharp
"Server=.;Database=Familia22i1L9;Integrated Security=true;TrustServerCertificate=true;Encrypt=false;"
```

Возможные варианты:
- Для именованного экземпляра: `Server=.\\SQLEXPRESS;...`
- Для удаленного сервера: `Server=server_name;...`
- Для SQL Server Authentication: `Server=.;Database=Familia22i1L9;User Id=username;Password=password;...`

### 6. Запуск приложения
После настройки базы данных запустите приложение:
```
dotnet run
```

## Устранение проблем

### Ошибка "Maximum number of retries exceeded"
Эта ошибка означает, что приложение не может подключиться к базе данных:

1. **Используйте встроенную диагностику**: Нажмите кнопку "Тест подключения" в приложении
2. **Проверьте SQL Server**: Убедитесь, что SQL Server запущен
3. **Проверьте имя экземпляра**: 
   - Для SQL Server Express: `Server=.\\SQLEXPRESS;...`
   - Для LocalDB: `Server=(localdb)\\mssqllocaldb;...`
4. **Проверьте базу данных**: Убедитесь, что база `Familia22i1L9` существует

### Ошибка подключения
Если возникает ошибка подключения:
1. Убедитесь, что SQL Server запущен
2. Проверьте, что SQL Server Browser запущен (для именованных экземпляров)
3. Убедитесь, что TCP/IP протокол включен в SQL Server Configuration Manager

### Ошибка аутентификации
Если используется SQL Server Authentication:
1. Убедитесь, что Mixed Mode Authentication включен
2. Создайте пользователя с правами на базу данных
3. Обновите строку подключения с учетными данными

### База данных не найдена
1. Выполните скрипт `CreateDatabase.sql` в SSMS
2. Или используйте кнопку "Создать БД" в форме диагностики приложения